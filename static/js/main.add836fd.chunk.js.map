{"version":3,"sources":["worker.ts","robot/tic-tac-toe/Board.ts","robot/tic-tac-toe/CustomTicTacToe.ts","robot/tic-tac-toe/FullBoard.ts","robot/tic-tac-toe/GameVsAi.ts","App.tsx","index.tsx"],"names":["addMethods","methods","module","exports","w","Worker","name","WinStatus","winningBoards","CustomTicTacToeBoard","presence","color","lastPerformedMove","printEachMove","copy","this","board","checkStatus","IN_PROGRESS","Array","fill","undefined","map","_","index","filter","number","move","playerOneToMove","bitMask","some","PLAYER_X","PLAYER_O","DRAW","status","i","row","j","player","push","join","newBoard","FullBoard","currentBoard","boards","clone","every","innerBoard","idx","isEqual","exportBoard","getAvailableMoves","availableMoves","getAvailableMovesForOuterGrid","forEach","innerMove","boardToCheck","outerMove","Math","floor","performMove","updatePresenceAndColor","printBoard","getRows","length","winners","reduce","acc","playerO","playerX","g","getPrintedRows","a","b","c","res","x","console","log","exportedBoard","importBoard","getThinkingTimeForDifficulty","difficulty","GameVsAi","humanPlayer","worker","resolvePromise","onmessage","e","data","type","grid","getBoards","selectedSquare","currentPlayer","getPlayerToMove","winStatus","includes","getState","JSON","stringify","promise","Promise","resolve","timeToThink","postMessage","FullScreenContainer","styled","div","BoardWrapper","TicTacContainer","p","isSelectable","isWon","gap","isSelected","DifficultyContainer","Square","state","getColor","game","App","useState","setGrid","localSelectedSquare","setLocalSelectedSquare","setDifficulty","useEffect","getNextAiMove","doThing","onClick","s","getStateFromWinStatus","window","location","reload","square","squareIdx","key","getBoard","box","boxIdx","ev","stopPropagation","newState","handleBoxClick","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.add836fd.chunk.js","sourcesContent":["\n\t\t\t\tvar addMethods = require(\"../node_modules/workerize-loader/dist/rpc-wrapper.js\")\n\t\t\t\tvar methods = []\n\t\t\t\tmodule.exports = function() {\n\t\t\t\t\tvar w = new Worker(__webpack_public_path__ + \"22606a39f9aab4dcee65.worker.js\", { name: \"[hash].worker.js\" })\n\t\t\t\t\taddMethods(w, methods)\n\t\t\t\t\t\n\t\t\t\t\treturn w\n\t\t\t\t}\n\t\t\t","export interface Board {\n  clone(): Board;\n  getAvailableMoves(): Array<number>;\n  getPlayerToMove(): WinStatus;\n  getLatestPlayerToMove(): WinStatus;\n  getOpposedStatus(status: WinStatus): WinStatus;\n  performMove(move: number): void;\n  checkStatus(): WinStatus;\n  printBoard(): void;\n  isEqual(board: any): boolean;\n}\n\nexport enum WinStatus {\n  IN_PROGRESS = \"IN_PROGRESS\",\n  DRAW = \"DRAW\",\n  PLAYER_X = \"PLAYER_X\",\n  PLAYER_O = \"PLAYER_O\",\n}\n","import { WinStatus } from \"./Board\";\n\nconst winningBoards: Array<number> = [\n  0b111000000,\n  0b000111000,\n  0b000000111,\n  0b100100100,\n  0b010010010,\n  0b001001001,\n  0b100010001,\n  0b001010100,\n];\n\ninterface ExportedBoard {\n  presence: number;\n  color: number;\n}\nexport class CustomTicTacToeBoard {\n  presence: number = 0;\n  color: number = 0;\n  lastPerformedMove: WinStatus | null = null;\n  printEachMove: boolean = false;\n\n  clone() {\n    const copy = new CustomTicTacToeBoard();\n    copy.presence = this.presence;\n    copy.color = this.color;\n    copy.lastPerformedMove = this.lastPerformedMove;\n    return copy;\n  }\n\n  isEqual(board: CustomTicTacToeBoard) {\n    return board.presence === this.presence && board.color === this.color;\n  }\n\n  static importBoard(board: ExportedBoard) {\n    const newBoard = new CustomTicTacToeBoard();\n    newBoard.presence = board.presence;\n    newBoard.color = board.color;\n    return newBoard;\n  }\n\n  exportBoard(): ExportedBoard {\n    return {\n      presence: this.presence,\n      color: this.color,\n    };\n  }\n\n  getAvailableMoves(): Array<number> {\n    if (this.checkStatus() !== WinStatus.IN_PROGRESS) return [];\n\n    return new Array(9)\n      .fill(undefined)\n      .map((_, index) => index)\n      .filter((number) => {\n        const bitMask = 2 ** number;\n        return (bitMask & this.presence) === 0;\n      });\n  }\n\n  performMove(move: number, playerOneToMove: boolean) {\n    const bitMask = 2 ** move;\n\n    this.presence = this.presence | bitMask;\n    if (playerOneToMove) {\n      this.color = this.color | bitMask;\n    }\n  }\n\n  checkStatus() {\n    if (\n      winningBoards.some(\n        (board) => (this.presence & board & this.color) === board\n      )\n    )\n      return WinStatus.PLAYER_X;\n\n    if (\n      winningBoards.some(\n        (board) => (this.presence & board & ~this.color) === board\n      )\n    )\n      return WinStatus.PLAYER_O;\n\n    if (this.presence === 0b111111111) return WinStatus.DRAW;\n    return WinStatus.IN_PROGRESS;\n  }\n\n  getOpposedStatus(status: WinStatus) {\n    if (status === WinStatus.PLAYER_O) return WinStatus.PLAYER_X;\n    return WinStatus.PLAYER_O;\n  }\n\n  getRows() {\n    return new Array(9)\n      .fill(undefined)\n      .map((_, index) => index)\n      .map((number) => {\n        const bitMask = 2 ** number;\n        if ((bitMask & this.presence) === 0) return \"empty\";\n        else if ((bitMask & this.presence & this.color) === 0) return \"player2\";\n        return \"player1\";\n      });\n  }\n\n  getPrintedRows(): string[] {\n    const board = [];\n\n    for (let i = 0; i < 3; i++) {\n      const row = [];\n\n      for (let j = 0; j < 3; j++) {\n        const move = i * 3 + j;\n        if ((2 ** move) & this.presence) {\n          const player = (2 ** move) & this.color;\n          row.push(player ? \"x\" : \"o\");\n        } else row.push(\" \");\n      }\n      board.push(`| ${row.join(\" \")} |`);\n    }\n\n    return board;\n  }\n}\n","import { Board, WinStatus } from \"./Board\";\nimport { CustomTicTacToeBoard } from \"./CustomTicTacToe\";\n\nconst winningBoards: Array<number> = [\n  0b111000000,\n  0b000111000,\n  0b000000111,\n  0b100100100,\n  0b010010010,\n  0b001001001,\n  0b100010001,\n  0b001010100,\n];\n\ninterface ExportedBoard {\n  color: number;\n  presence: number;\n  currentBoard: number | null;\n  boards: Array<{ presence: number; color: number }>;\n  playerOneToMove: boolean;\n}\nexport class FullBoard implements Board {\n  printEachMove: boolean = false;\n  currentBoard: number | null = null;\n  presence: number = 0;\n  color: number = 0;\n  playerOneToMove: boolean = true;\n  boards: Array<CustomTicTacToeBoard> = [];\n\n  constructor() {\n    for (let i = 0; i < 9; i++) {\n      this.boards.push(new CustomTicTacToeBoard());\n    }\n  }\n\n  clone() {\n    const copy = new FullBoard();\n    copy.currentBoard = this.currentBoard;\n    copy.presence = this.presence;\n    copy.color = this.color;\n    copy.playerOneToMove = this.playerOneToMove;\n    copy.boards = this.boards.map((board) => board.clone());\n    return copy;\n  }\n\n  isEqual(board: FullBoard) {\n    return (\n      this.color === board.color &&\n      this.presence === board.presence &&\n      this.currentBoard === board.currentBoard &&\n      this.playerOneToMove === board.playerOneToMove &&\n      this.boards.every((innerBoard, idx) =>\n        innerBoard.isEqual(board.boards[idx])\n      )\n    );\n  }\n\n  static importBoard(exportedBoard: ExportedBoard) {\n    const newBoard = new FullBoard();\n    newBoard.color = exportedBoard.color;\n    newBoard.presence = exportedBoard.presence;\n    newBoard.currentBoard = exportedBoard.currentBoard;\n    newBoard.boards = exportedBoard.boards.map((board) =>\n      CustomTicTacToeBoard.importBoard(board)\n    );\n    newBoard.playerOneToMove = exportedBoard.playerOneToMove;\n    return newBoard;\n  }\n\n  exportBoard(): ExportedBoard {\n    return {\n      color: this.color,\n      presence: this.presence,\n      currentBoard: this.currentBoard,\n      boards: this.boards.map((board) => board.exportBoard()),\n      playerOneToMove: this.playerOneToMove,\n    };\n  }\n\n  private getAvailableMovesForOuterGrid() {\n    return new Array(9)\n      .fill(undefined)\n      .map((_, index) => index)\n      .filter((number) => {\n        const bitMask = 2 ** number;\n        return (bitMask & this.presence) === 0;\n      });\n  }\n\n  getAvailableMoves() {\n    // if there is a selected board\n    if (this.currentBoard !== null)\n      return this.boards[this.currentBoard].getAvailableMoves();\n\n    const availableMoves: Array<number> = [];\n    this.getAvailableMovesForOuterGrid().forEach((move) => {\n      const board = this.boards[move];\n      if (board.checkStatus() === WinStatus.IN_PROGRESS) {\n        board.getAvailableMoves().forEach((innerMove) => {\n          availableMoves.push(move * 10 + innerMove + 10);\n        });\n      }\n    });\n\n    return availableMoves;\n  }\n\n  getPlayerToMove() {\n    return this.playerOneToMove ? WinStatus.PLAYER_X : WinStatus.PLAYER_O;\n  }\n\n  getLatestPlayerToMove() {\n    return this.playerOneToMove ? WinStatus.PLAYER_O : WinStatus.PLAYER_X;\n  }\n\n  private updatePresenceAndColor(boardToCheck: number) {\n    const board = this.boards[boardToCheck];\n\n    const status = board.checkStatus();\n    // lets do nothing for draws for the moment and see how it works out\n    if (status !== WinStatus.IN_PROGRESS && status !== WinStatus.DRAW) {\n      const bitMask = 2 ** boardToCheck;\n      this.presence = this.presence | bitMask;\n\n      if (status === WinStatus.PLAYER_X) {\n        this.color = this.color | bitMask;\n      }\n    }\n  }\n\n  performMove(move: number) {\n    const outerMove = move < 9 ? this.currentBoard : Math.floor(move / 10) - 1;\n    const innerMove = move < 9 ? move : move % 10;\n\n    // @ts-ignore\n    this.boards[outerMove].performMove(innerMove, this.playerOneToMove);\n\n    const statusOfNextBoard = this.boards[innerMove].checkStatus();\n\n    if (statusOfNextBoard === WinStatus.IN_PROGRESS)\n      this.currentBoard = innerMove;\n    else {\n      this.currentBoard = null;\n    }\n\n    // @ts-ignore\n    this.updatePresenceAndColor(outerMove);\n\n    this.playerOneToMove = !this.playerOneToMove;\n\n    if (this.printEachMove) this.printBoard();\n  }\n\n  getBoards() {\n    return this.boards.map((board) => board.getRows());\n  }\n\n  checkStatus() {\n    if (\n      winningBoards.some(\n        (board) => (this.presence & board & this.color) === board\n      )\n    )\n      return WinStatus.PLAYER_X;\n\n    if (\n      winningBoards.some(\n        (board) => (this.presence & board & ~this.color) === board\n      )\n    )\n      return WinStatus.PLAYER_O;\n\n    if (this.getAvailableMoves().length === 0) {\n      const winners = this.boards.reduce(\n        (acc, board) => {\n          if (board.checkStatus() === WinStatus.PLAYER_O)\n            return { ...acc, playerO: acc.playerO + 1 };\n          if (board.checkStatus() === WinStatus.PLAYER_X)\n            return { ...acc, playerX: acc.playerX + 1 };\n          return acc;\n        },\n        { playerO: 0, playerX: 0 }\n      );\n      if (winners.playerO > winners.playerX) return WinStatus.PLAYER_O;\n      if (winners.playerX > winners.playerO) return WinStatus.PLAYER_X;\n      return WinStatus.DRAW;\n    }\n    return WinStatus.IN_PROGRESS;\n  }\n\n  getOpposedStatus(status: WinStatus) {\n    if (status === WinStatus.PLAYER_O) return WinStatus.PLAYER_X;\n    return WinStatus.PLAYER_O;\n  }\n  printBoard() {\n    const board = [];\n    for (let i = 0; i < 3; i++) {\n      const row: string[][] = [[], [], []];\n      for (let j = 0; j < 3; j++) {\n        const g = i * 3 + j;\n        const [a, b, c] = this.boards[g].getPrintedRows();\n\n        row[0].push(a);\n        row[1].push(b);\n        row[2].push(c);\n      }\n      const res = row.map((x) => x.join(\"    \")).join(\"\\n\");\n      board.push(res);\n    }\n    console.log(\n      `\nGame status: ${this.checkStatus()} -- Current square: ${\n        this.currentBoard !== null ? this.currentBoard + 1 : \"None\"\n      }\n\n${board.join(\"\\n\\n\")}\n`\n    );\n  }\n}\n","import { WinStatus } from \"./Board\";\nimport { FullBoard } from \"./FullBoard\";\n// @ts-ignore\nimport worker from \"workerize-loader!../../worker\"; // eslint-disable-line\n\nconst getThinkingTimeForDifficulty = (\n  difficulty: \"easy\" | \"intermediate\" | \"hard\"\n) => {\n  switch (difficulty) {\n    case \"easy\":\n      return 500;\n    case \"intermediate\":\n      return 1000;\n    case \"hard\":\n      return 1500;\n  }\n};\n\nexport class GameVsAi {\n  private humanPlayer: WinStatus = WinStatus.PLAYER_X;\n  private board = new FullBoard();\n  private worker: any;\n  private resolvePromise: any;\n\n  constructor(humanPlayer: WinStatus = WinStatus.PLAYER_X) {\n    this.humanPlayer = humanPlayer;\n\n    this.worker = new worker();\n    this.worker.onmessage = (e: any) => {\n      if (e.data.type === \"RPC\") return;\n      this.resolvePromise(e.data);\n    };\n  }\n\n  getBoard() {\n    return this.board;\n  }\n\n  getState() {\n    return {\n      grid: this.board.getBoards(),\n      selectedSquare: this.board.currentBoard,\n      currentPlayer: this.board.getPlayerToMove(),\n      winStatus: this.board.checkStatus(),\n    };\n  }\n\n  performMove(move: number) {\n    if (!this.board.getAvailableMoves().includes(move)) {\n      console.log(\n        `tried to perform move ${move}.\\n available moves are \\n ${JSON.stringify(\n          this.board.getAvailableMoves()\n        )}`\n      );\n      return this.getState();\n    }\n    console.log(`performed move: ${move}`);\n\n    this.board.performMove(move);\n    return this.getState();\n  }\n\n  async getNextAiMove(difficulty: \"easy\" | \"intermediate\" | \"hard\") {\n    const promise = new Promise<any>((resolve) => {\n      this.resolvePromise = resolve;\n    });\n\n    const timeToThink = getThinkingTimeForDifficulty(difficulty);\n    this.worker.postMessage([\n      this.board.exportBoard(),\n      WinStatus.PLAYER_O,\n      timeToThink,\n    ]);\n    const exportedBoard = await promise;\n    this.board = FullBoard.importBoard(exportedBoard);\n  }\n}\n","import React, { useState, useEffect } from \"react\";\nimport styled from \"styled-components\";\nimport { GameVsAi } from \"./robot/tic-tac-toe/GameVsAi\";\nimport { WinStatus } from \"./robot/tic-tac-toe/Board\";\n\nconst FullScreenContainer = styled.div`\n  width: 100vw;\n  height: 100vh;\n\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  overflow: hidden;\n`;\n\nconst BoardWrapper = styled.div`\n  width: 60vmin;\n  height: 60vmin;\n\n  @media (max-width: 768px) {\n    width: 80vmin;\n    height: 80vmin;\n  }\n\n  @media (max-width: 480px) {\n    width: 95vmin;\n    height: 95vmin;\n  }\n`;\n\nconst TicTacContainer = styled.div<{\n  gap?: boolean;\n  isSelected?: boolean;\n  isSelectable?: boolean;\n  isWon?: WinStatus | false;\n}>`\n  width: 100%;\n  height: 100%;\n  display: grid;\n  position: relative;\n  grid-template-columns: repeat(3, 1fr);\n  grid-template-rows: repeat(3, 1fr);\n  ${p => p.isSelectable && \"cursor: pointer\"}\n\n  ${p => p.isWon === WinStatus.PLAYER_X && \"border: 3px solid blue\"}\n  ${p => p.isWon === WinStatus.PLAYER_O && \"border: 3px solid green\"}\n\n  ${p =>\n    p.gap &&\n    `\n  grid-gap: 64px;\n\n  @media (max-width: 768px) {\n    grid-gap: 16px;\n  }\n\n  @media (max-width: 480px) {\n    grid-gap: 8px\n  }\n`};\n\n  &:after {\n    ${p =>\n      p.isWon &&\n      `\n\n            content: '';\n            position: absolute;\n            top: 0;\n            bottom: 0;\n            left: 0;\n            right: 0;\n            background-color: ${\n              p.isWon === WinStatus.PLAYER_X ? \"blue\" : \"green\"\n            };\n            opacity: 0.3;\n              `}\n  }\n\n  ${p => p.isSelected && \"border: 3px solid yellow\"}\n`;\n\nconst DifficultyContainer = styled.div`\n  & > button {\n    font-size: 1.5rem;\n    background-color: white;\n    border-radius: 8px;\n    padding: 8px;\n    cursor: pointer;\n    -webkit-appearance: none;\n\n    &:not(:last-child) {\n      margin-right: 16px;\n    }\n  }\n`;\n\nconst getColor = (state: \"empty\" | \"player1\" | \"player2\") => {\n  switch (state) {\n    case \"empty\": {\n      return \"white\";\n    }\n    case \"player1\": {\n      return \"blue\";\n    }\n    case \"player2\": {\n      return \"green\";\n    }\n  }\n};\n\nconst getStateFromWinStatus = (status: WinStatus, difficulty: string) => {\n  let s = \"\";\n  switch (status) {\n    case WinStatus.PLAYER_O:\n      s = \"Robot wins! Better luck next time.\";\n      break;\n    case WinStatus.PLAYER_X:\n      s = `You win! Congratulations on beating the ${difficulty} difficulty!`;\n      break;\n    case WinStatus.DRAW:\n      s = \"It's a draw!\";\n      break;\n  }\n  return `${s} To start a new game, refresh the page.`;\n};\n\nconst Square = styled.div<{ state: \"empty\" | \"player1\" | \"player2\" }>`\n  border: 1px solid black;\n  background-color: ${p => getColor(p.state)};\n  ${p => p.state !== \"empty\" && \"cursor: default\"}\n`;\n\nconst game = new GameVsAi();\nexport const App = () => {\n  const [\n    { grid, selectedSquare, currentPlayer, winStatus },\n    setGrid\n  ] = useState(game.getState());\n  const [localSelectedSquare, setLocalSelectedSquare] = useState<number | null>(\n    null\n  );\n  const [difficulty, setDifficulty] = useState<\n    \"easy\" | \"intermediate\" | \"hard\" | null\n  >(null);\n\n  const handleSquareClick = (idx: number) => {\n    if (\n      currentPlayer !== WinStatus.PLAYER_X ||\n      winStatus !== WinStatus.IN_PROGRESS ||\n      game.getBoard().boards[idx].checkStatus() !== WinStatus.IN_PROGRESS\n    )\n      return;\n    if (selectedSquare !== null) return;\n    setLocalSelectedSquare(idx);\n  };\n\n  const handleBoxClick = (ev: any, squareIdx: number, boxIdx: number) => {\n    if (\n      currentPlayer !== WinStatus.PLAYER_X ||\n      winStatus !== WinStatus.IN_PROGRESS\n    )\n      return;\n    if (selectedSquare === squareIdx) {\n      ev.stopPropagation();\n      game.performMove(boxIdx);\n\n      setGrid(game.getState());\n    }\n    if (localSelectedSquare !== squareIdx) return;\n\n    const newState = game.performMove((localSelectedSquare + 1) * 10 + boxIdx);\n    setGrid(newState);\n  };\n\n  useEffect(() => {\n    setLocalSelectedSquare(null);\n  }, [selectedSquare]);\n\n  useEffect(() => {\n    if (currentPlayer === WinStatus.PLAYER_O) {\n      const doThing = async () => {\n        if (difficulty === null) return;\n        await game.getNextAiMove(difficulty);\n        setGrid(game.getState());\n      };\n      doThing();\n    }\n  }, [currentPlayer, difficulty]);\n\n  return (\n    <FullScreenContainer>\n      {difficulty === null ? (\n        <DifficultyContainer>\n          <h1>Select difficulty</h1>\n          <button onClick={() => setDifficulty(\"easy\")}>Easy</button>\n          <button onClick={() => setDifficulty(\"intermediate\")}>\n            Intermediate\n          </button>\n          <button onClick={() => setDifficulty(\"hard\")}>Hard</button>\n        </DifficultyContainer>\n      ) : (\n        <BoardWrapper>\n          {winStatus !== WinStatus.IN_PROGRESS && (\n            <>\n              <p>{getStateFromWinStatus(winStatus, difficulty)}</p>\n              <button onClick={() => window.location.reload()}>Refresh</button>\n            </>\n          )}\n          {winStatus === WinStatus.IN_PROGRESS ? (\n            currentPlayer === WinStatus.PLAYER_X ? (\n              <p>It is your turn to move</p>\n            ) : (\n              <p>Robot is thinking...</p>\n            )\n          ) : null}\n          <TicTacContainer gap={true}>\n            {grid.map((square, squareIdx) => (\n              <TicTacContainer\n                key={squareIdx}\n                isWon={\n                  [WinStatus.PLAYER_O, WinStatus.PLAYER_X].includes(\n                    game.getBoard().boards[squareIdx].checkStatus()\n                  ) && game.getBoard().boards[squareIdx].checkStatus()\n                }\n                isSelected={\n                  squareIdx === selectedSquare ||\n                  squareIdx === localSelectedSquare\n                }\n                isSelectable={\n                  (squareIdx === selectedSquare ||\n                    squareIdx === localSelectedSquare ||\n                    selectedSquare === null) &&\n                  currentPlayer === WinStatus.PLAYER_X\n                }\n                onClick={() => handleSquareClick(squareIdx)}\n              >\n                {square.map((box, boxIdx) => (\n                  <Square\n                    key={boxIdx}\n                    onClick={ev => handleBoxClick(ev, squareIdx, boxIdx)}\n                    state={box}\n                  />\n                ))}\n              </TicTacContainer>\n            ))}\n          </TicTacContainer>\n        </BoardWrapper>\n      )}\n    </FullScreenContainer>\n  );\n};\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { App } from \"./App\";\n\nimport \"./global.css\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}